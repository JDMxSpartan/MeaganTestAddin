function onMessageSendHandler(e){Office.context.mailbox.item.body.getAsync("text",{asyncContext:e},getBodyCallback)}function getBodyCallback(e){const n=e.asyncContext;let t="";if(e.status===Office.AsyncResultStatus.Failed||void 0===e.value){const e="Failed to get body text";return console.error(e),void n.completed({allowEvent:!1,errorMessage:e})}t=e.value,bannerNullHandler(getBannerFromBody(t),n)}function getBannerFromBody(e){const n=e.match(/^(TOP *SECRET|TS|SECRET|S|CONFIDENTIAL|C|UNCLASSIFIED|U)((\/\/)?(.*)?(\/\/)((.*)*))?/im);return console.log(n),n?(console.log("banner found"),n[0]):(console.log("banner null"),null)}function bannerNullHandler(e,n){null==e?n.completed({allowEvent:!1,cancelLabel:"Ok",commandId:"msgComposeOpenPaneButton",contextData:JSON.stringify({a:"aValue",b:"bValue"}),errorMessage:"Please enter a banner, banner error detected.",sendModeOverride:Office.MailboxEnums.SendModeOverride.PromptUser}):n.completed({allowEvent:!0})}function hasMatches(e){if(null==e||""==e)return!1;const n=["send","picture","document","attachment"];for(let t=0;t<n.length;t++){const o=n[t].trim();if(RegExp(o,"i").test(e))return!0}return!1}function getAttachmentsCallback(e){const n=e.asyncContext;if(e.value.length>0){for(let t=0;t<e.value.length;t++)if(0==e.value[t].isInline)return void n.completed({allowEvent:!0});n.completed({allowEvent:!1,errorMessage:"Looks like the body of your message includes an image or an inline file. Would you like to attach a copy of it to the message?",cancelLabel:"Attach a copy",commandId:"msgComposeOpenPaneButton",sendModeOverride:Office.MailboxEnums.SendModeOverride.PromptUser})}else n.completed({allowEvent:!1,errorMessage:"Looks like you're forgetting to include an attachment blayh blah testing.",cancelLabel:"Add an attachment",commandId:"msgComposeOpenPaneButton"})}Office.context.platform!==Office.PlatformType.PC&&null!=Office.context.platform||Office.actions.associate("onMessageSendHandler",onMessageSendHandler);